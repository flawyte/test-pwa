<html><head><link rel="import" href="../bower_components/app-route/app-location.html"><link rel="import" href="../bower_components/paper-button/paper-button.html"><link rel="import" href="../bower_components/paper-toast/paper-toast.html"><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="fragments/main-fragment.html"><link rel="import" href="fragments/splash-fragment.html"><link rel="import" href="single-fragment-container.html"></head><body><dom-module id="test-pwa-app"><template><style>:host{background:#eeeeee;display:block;height:100%;}paper-toast{font-size:1em;}paper-toast paper-button{color:#eeff41;}#frame{height:100%;width:100%;}#frame > *{height:100%;position:absolute;width:100%;}</style><app-location id="location" path="{{path}}" use-hash-as-path="[[useHashAsPath]]"></app-location><div id="frame"><div><splash-fragment id="splash" class="fragment"></splash-fragment></div><div><main-fragment id="main" class="fragment" path="{{path}}"></main-fragment></div></div><paper-toast id="toast"><paper-button id="positiveButton" on-tap="_onToastPositiveButtonTapped"></paper-button></paper-toast></template><script>var TestPwaApp=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:'ready',value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'ready',this).call(this),this._setUpFragments(Array.prototype.slice.call(this.shadowRoot.querySelectorAll('.fragment'))),this.setVisibleFragmentByTag('splash-fragment'),navigator.serviceWorker&&this.registerServiceWorker()}},{key:'registerServiceWorker',value:function(){var d=this;navigator.serviceWorker.register('sw.js').then(function(f){var g=!1;try{var h=Object.defineProperty({},'passive',{get:function(){g=!0}});window.addEventListener('test',null,h)}catch(i){}f.addEventListener('updatefound',function(){var k,l,i=f.active,j=f.installing;i?(l='Reload to update',k='New version available'):(l='Reload to finish',k='Installation is almost complete'),j.addEventListener('statechange',function(){d.$.positiveButton.textContent=l,d.$.toast.text=k,'activated'==j.state&&d.$.toast.show({duration:Infinity})},!!g&&{passive:!0})},!!g&&{passive:!0})})}},{key:'_onToastPositiveButtonTapped',value:function(){window.location.reload(!0)}},{key:'__pathChanged',value:function(d){d.startsWith('/')||(this.path='/'+d)}},{key:'useHashAsPath',get:function(){return-1<window.location.origin.indexOf('flawyte.github.io')}}],[{key:'properties',get:function(){return{path:{observer:'__pathChanged'}}}},{key:'is',get:function(){return'test-pwa-app'}}]),b}(SingleFragmentContainer(Polymer.Element));window.customElements.define(TestPwaApp.is,TestPwaApp),window.addEventListener('beforeinstallprompt',function(a){return localStorage.getItem('showed-install-banner')?void a.preventDefault():void a.userChoice.then(function(){localStorage.setItem('showed-install-banner',!0)})});</script></dom-module></body></html>