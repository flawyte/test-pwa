<html><head><link rel="import" href="../../bower_components/app-route/app-location.html"><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../fragments/home-fragment.html"><link rel="import" href="../fragments/image-details-fragment.html"><link rel="import" href="../views/fragments/main-view.html"></head><body><dom-module id="main-fragment"><template><style>:host{display:block;height:100%;width:100%;}</style><main-view><home-fragment id="home" data-route=""></home-fragment><image-details-fragment id="details" data-route="photos/([0-9]+):id"></image-details-fragment></main-view><app-location id="location" on-route-changed="_onRouteChanged"></app-location></template><script>var MainFragment=function(a){function b(){babelHelpers.classCallCheck(this,b);var c=babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.fragments=[],c.ignoreNextRouteChange=!0,c.visibleFragments=[],c}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:'_dataFromPath',value:function(d,f){var g=this._extractParamsFromRoute(f);if(0==g.length)return null;for(var h={},j=0;j<g.length;j++){var k=g[j],l=k.split(':')[1],m=k.split(':')[0],n=d.match(new RegExp(f.replace(''+k,'('+m+')')))[1];h[l]=n}return h}},{key:'_extractParamsFromRoute',value:function(d){var f=d.match(/(\(.*\):[a-zA-Z]+)\/?/);return f?f.slice(1):[]}},{key:'_onRouteChanged',value:function(){this.ignoreNextRouteChange||this.setPath(this.$.location.path.slice(1)),this.ignoreNextRouteChange=!1}},{key:'_pathToFragment',value:function(d){var f=this.fragments.find(function(g){var h=g.dataset.route,j=h.replace(/:\w+/,''),k=new RegExp('^'+j+'$').test(d);return k});return f||null}}],[{key:'is',get:function(){return'main-fragment'}},{key:'properties',get:function(){return{basePath:{type:String}}}}]),babelHelpers.createClass(b,[{key:'initFragments',value:function(){var d=this;this.fragments=[this.$.details,this.$.home],this.fragments.forEach(function(f){f.frame=d,f.style.display='none'})}},{key:'onVisible',value:function(){this.setPath('')}},{key:'ready',value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'ready',this).call(this),this.initFragments()}},{key:'setPath',value:function(d){var f=this._pathToFragment(d),g=this._dataFromPath(d,f.dataset.route);this.setVisibleFragment(f,g),d=this.basePath+d,d!=this.$.location.path&&(this.ignoreNextRouteChange=!0,this.$.location.path=d)}},{key:'setVisibleFragment',value:function(d,f){return-1===this.visibleFragments.indexOf(d)?void(this.visibleFragments.forEach(function(g){g.style.display='none','function'===typeof g.onInvisible&&g.onInvisible()}),d.style.display='','function'===typeof d.onVisible&&d.onVisible(),'function'===typeof d.onData&&d.onData(f),this.visibleFragments=[d]):void('function'===typeof d.onData&&d.onData(f))}}]),b}(Polymer.Element);window.customElements.define(MainFragment.is,MainFragment);</script></dom-module></body></html>